import{j as e,x as t,m as s,F as a,n as l,P as n,k as r,d as i,T as o}from"./ui-vendor-DKQiA0eN.js";import{f as d,r as c}from"./react-vendor-UBAF-OWM.js";import{d as x}from"./db-D0LAGLHJ.js";import{E as m,a as u}from"./pdf-vendor-0-8C3xHX.js";function h(){const h=d(),[p,f]=c.useState([]),[g,j]=c.useState(!0),[b,N]=c.useState(!1),[v,w]=c.useState(""),[y,D]=c.useState("");c.useEffect(()=>{C();const e=setInterval(()=>{f(e=>[...e])},1e3);return()=>clearInterval(e)},[]);const C=async()=>{try{const e=await x.getAllCountdowns();f(e.sort((e,t)=>e.targetDate.getTime()-t.targetDate.getTime()))}catch(e){}finally{j(!1)}};return e.jsxs("div",{className:"min-h-screen bg-slate-50 p-6 pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>h(-1),className:"p-2 bg-white rounded-full shadow-sm hover:bg-slate-100 transition-colors",children:e.jsx(t,{className:"h-6 w-6 text-slate-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Countdowns"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>{const e=JSON.stringify(p,null,2),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="countdowns.json",document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"flex items-center gap-2 bg-white text-slate-600 px-3 py-2 rounded-lg hover:bg-slate-50 transition-colors shadow-sm text-sm font-medium",title:"Export JSON",children:[e.jsx(s,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"JSON"})]}),e.jsxs("button",{onClick:()=>{const e=new m;e.text("Countdowns",14,15);const t=p.map(e=>[e.title,e.targetDate.toLocaleString()]);u(e,{head:[["Title","Target Date"]],body:t,startY:20}),e.save("countdowns.pdf")},className:"flex items-center gap-2 bg-white text-slate-600 px-3 py-2 rounded-lg hover:bg-slate-50 transition-colors shadow-sm text-sm font-medium",title:"Export PDF",children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"PDF"})]}),e.jsxs("label",{className:"flex items-center gap-2 bg-white text-slate-600 px-3 py-2 rounded-lg hover:bg-slate-50 transition-colors shadow-sm text-sm font-medium cursor-pointer",children:[e.jsx(l,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Import"}),e.jsx("input",{type:"file",accept:".json",onChange:e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(!s)return;const a=new FileReader;a.onload=async e=>{var t;try{const s=JSON.parse(null==(t=e.target)?void 0:t.result);if(Array.isArray(s)){for(const e of s){const t={...e,targetDate:new Date(e.targetDate)};await x.saveCountdown(t)}C(),alert("Countdowns imported successfully!")}}catch(s){alert("Failed to import. Invalid format.")}},a.readAsText(s)},className:"hidden"})]}),e.jsxs("button",{onClick:()=>N(!b),className:"flex items-center gap-2 bg-primary-600 text-white px-4 py-2 rounded-full hover:bg-primary-700 transition-colors shadow-md ml-2",children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{children:"New Timer"})]})]})]}),b&&e.jsx("div",{className:"glass-card p-6 rounded-2xl mb-8 animate-in slide-in-from-top-4 fade-in",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!v||!y)return;const t={id:crypto.randomUUID(),title:v,targetDate:new Date(y)};await x.saveCountdown(t),f([...p,t].sort((e,t)=>e.targetDate.getTime()-t.targetDate.getTime())),N(!1),w(""),D("")},className:"flex flex-col md:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),placeholder:"e.g., Final Exams",className:"w-full rounded-xl border-slate-200 focus:border-primary-500 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Target Date"}),e.jsx("input",{type:"datetime-local",value:y,onChange:e=>D(e.target.value),className:"w-full rounded-xl border-slate-200 focus:border-primary-500 focus:ring-primary-500",required:!0})]}),e.jsx("button",{type:"submit",className:"w-full md:w-auto bg-slate-800 text-white px-6 py-2.5 rounded-xl hover:bg-slate-700 transition-colors",children:"Start"})]})}),g?e.jsx("div",{className:"text-center py-10 text-slate-500",children:"Loading timers..."}):0===p.length?e.jsx("div",{className:"text-center py-20 text-slate-400",children:e.jsx("p",{children:"No active countdowns. Add one to track important dates!"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:p.map(t=>{const s=(e=>{const t=e.getTime()-(new Date).getTime();if(t<=0)return{days:0,hours:0,minutes:0,seconds:0,expired:!0};const s=Math.floor(t/1e3%60),a=Math.floor(t/1e3/60%60),l=Math.floor(t/36e5%24);return{days:Math.floor(t/864e5),hours:l,minutes:a,seconds:s,expired:!1}})(t.targetDate);return e.jsxs("div",{className:"glass-card p-6 rounded-3xl relative group overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600",children:e.jsx(r,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:t.title}),e.jsxs("p",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(i,{className:"h-3 w-3"}),t.targetDate.toLocaleDateString()]})]})]}),e.jsx("button",{onClick:()=>(async e=>{confirm("Delete this countdown?")&&(await x.deleteCountdown(e),f(p.filter(t=>t.id!==e)))})(t.id),className:"p-2 hover:bg-red-50 text-slate-300 hover:text-red-500 rounded-full transition-colors",children:e.jsx(o,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-2",children:[e.jsx("div",{className:"text-xl font-bold text-slate-800",children:s.days}),e.jsx("div",{className:"text-[10px] uppercase text-slate-400 font-bold",children:"Days"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-2",children:[e.jsx("div",{className:"text-xl font-bold text-slate-800",children:s.hours}),e.jsx("div",{className:"text-[10px] uppercase text-slate-400 font-bold",children:"Hrs"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-2",children:[e.jsx("div",{className:"text-xl font-bold text-slate-800",children:s.minutes}),e.jsx("div",{className:"text-[10px] uppercase text-slate-400 font-bold",children:"Mins"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-2",children:[e.jsx("div",{className:"text-xl font-bold text-slate-800",children:s.seconds}),e.jsx("div",{className:"text-[10px] uppercase text-slate-400 font-bold",children:"Secs"})]})]}),s.expired&&e.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center",children:e.jsx("span",{className:"text-red-500 font-bold text-lg",children:"Time's Up!"})})]},t.id)})})]})}export{h as Countdown};
