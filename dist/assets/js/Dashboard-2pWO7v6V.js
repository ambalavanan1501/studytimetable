import{j as e,m as t,k as s,n as a,o as l,T as r,p as n,X as i,B as o,h as c,F as d,R as x,l as m,q as u,r as h,Q as f}from"./ui-vendor-yoAZ-FXJ.js";import{e as p,r as j,a as g}from"./react-vendor-DR97ylRc.js";import{d as b,a as N,c as v,u as w,s as y}from"./index-CNb4MtWx.js";import{S as k}from"./SEO-DgSy9wkE.js";import"./pdf-vendor-CnZj0n1s.js";import"./supabase-vendor-C9Ts7tiD.js";function S(){const s=p(),[a,l]=j.useState(null);j.useEffect(()=>{r()},[]);const r=async()=>{const e=await b.getAllNotes();if(e.length>0){const t=e.sort((e,t)=>t.updatedAt.getTime()-e.updatedAt.getTime())[0];l(t)}else{const e={id:"quick-note",title:"Quick Note",content:"",updatedAt:new Date};await b.saveNote(e),l(e)}};return e.jsxs("div",{className:"glass-card p-5 rounded-3xl relative group h-full flex flex-col bg-yellow-50/30 border-yellow-100/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-400"}),"Quick Note"]}),e.jsx("button",{onClick:()=>s("/notes"),className:"p-1.5 rounded-full hover:bg-yellow-100 text-slate-400 hover:text-yellow-600 transition-colors",children:e.jsx(t,{className:"h-4 w-4"})})]}),e.jsx("textarea",{value:(null==a?void 0:a.content)||"",onChange:e=>(async e=>{if(a){const t={...a,title:a.title||"Quick Note",content:e,updatedAt:new Date};l(t),await b.saveNote(t)}})(e.target.value),placeholder:"Jot something down...",className:"flex-1 w-full bg-transparent border-none resize-none focus:ring-0 text-slate-600 placeholder:text-slate-400 p-0 text-sm leading-relaxed"})]})}function _(){const a=p(),[l,r]=j.useState(null),[n,i]=j.useState(null);j.useEffect(()=>{o();const e=setInterval(c,6e4);return()=>clearInterval(e)},[]);const o=async()=>{const e=await b.getAllCountdowns(),t=(new Date).getTime(),s=e.filter(e=>e.targetDate.getTime()>t).sort((e,t)=>e.targetDate.getTime()-t.targetDate.getTime());s.length>0&&(r(s[0]),d(s[0].targetDate))},c=()=>{l&&d(l.targetDate)},d=e=>{const t=e.getTime()-(new Date).getTime(),s=Math.floor(t/36e5%24),a=Math.floor(t/864e5);i({days:a,hours:s})};return e.jsxs("div",{className:"glass-card p-5 rounded-3xl relative group h-full flex flex-col bg-blue-50/30 border-blue-100/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:[e.jsx(s,{className:"h-4 w-4 text-blue-500"}),"Countdown"]}),e.jsx("button",{onClick:()=>a("/countdown"),className:"p-1.5 rounded-full hover:bg-blue-100 text-slate-400 hover:text-blue-600 transition-colors",children:e.jsx(t,{className:"h-4 w-4"})})]}),l&&n?e.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[e.jsx("p",{className:"text-sm text-slate-500 font-medium truncate mb-1",children:l.title}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-3xl font-bold text-slate-800",children:n.days}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase mr-2",children:"Days"}),e.jsx("span",{className:"text-xl font-bold text-slate-600",children:n.hours}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Hrs"})]})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-400 text-sm",children:"No active timers"})]})}function C(){const s=p(),[r,n]=j.useState([]);j.useEffect(()=>{i()},[]);const i=async()=>{const e=(await b.getAllTasks()).filter(e=>"done"!==(e.status||(e.completed?"done":"todo"))).sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime());n(e.slice(0,3))};return e.jsxs("div",{className:"glass-card p-5 rounded-3xl relative group h-full flex flex-col bg-emerald-50/30 border-emerald-100/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:[e.jsx(a,{className:"h-4 w-4 text-emerald-500"}),"Tasks"]}),e.jsx("button",{onClick:()=>s("/tasks"),className:"p-1.5 rounded-full hover:bg-emerald-100 text-slate-400 hover:text-emerald-600 transition-colors",children:e.jsx(t,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1 space-y-3",children:r.length>0?r.map(t=>e.jsxs("div",{className:"flex items-center gap-3 group/item",children:[e.jsx("button",{onClick:()=>(async e=>{if(r.find(t=>t.id===e)){const t=await b.getAllTasks().then(t=>t.find(t=>t.id===e));if(t){const s={...t,status:"done"};await b.saveTask(s),n(r.filter(t=>t.id!==e))}}})(t.id),className:"text-slate-400 hover:text-emerald-500 transition-colors",children:e.jsx(l,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm text-slate-600 truncate",children:t.text})]},t.id)):e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-sm",children:"No pending tasks"})})]})}function D({noteId:t,subjectId:s,initialTitle:a="",initialContent:l="",onClose:o,onSave:c}){const[d,x]=j.useState(a),[m,u]=j.useState(l),{addToast:h}=N();return e.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-slate-900 rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("input",{type:"text",placeholder:"Note Title",value:d,onChange:e=>x(e.target.value),className:"text-lg font-bold bg-transparent border-none focus:outline-none flex-1 text-slate-800 dark:text-slate-100 placeholder:text-slate-400"}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx("button",{onClick:async()=>{if(t&&window.confirm("Are you sure you want to delete this note?"))try{await b.deleteNote(t),h("Note deleted","info"),c(),o()}catch(e){}},className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Note",children:e.jsx(r,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:async()=>{if(d.trim())try{const e=t||crypto.randomUUID();await b.saveNote({id:e,subjectId:s,title:d,content:m,updatedAt:new Date}),h("Note saved successfully","success"),c(),o()}catch(e){h("Failed to save note","error")}else h("Please enter a title","error")},className:"p-2 text-primary-600 hover:bg-primary-50 rounded-lg transition-colors flex items-center gap-2",title:"Save Note",children:[e.jsx(n,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold text-sm",children:"Save"})]}),e.jsx("button",{onClick:o,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(i,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex-1 p-4 overflow-auto",children:e.jsx("textarea",{value:m,onChange:e=>u(e.target.value),placeholder:"Start typing your notes here...",className:"w-full h-full resize-none bg-transparent border-none focus:outline-none text-slate-700 dark:text-slate-300 leading-relaxed custom-scrollbar"})})]})}function T({isOpen:t,onClose:s,subjectName:a,subjectCode:l}){const[r,n]=j.useState([]),[x,m]=j.useState(null),[u,h]=j.useState(!1),[f,p]=j.useState(!0),N=l,w=async()=>{try{p(!0);const e=await b.getNotesBySubject(N);n(e||[])}catch(e){}finally{p(!1)}};if(j.useEffect(()=>{t&&w()},[t,N]),!t)return null;return g.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-4xl h-[80vh] bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden animate-in zoom-in-95 duration-300 flex",children:[e.jsxs("div",{className:v("w-full sm:w-1/3 border-r border-slate-200 dark:border-slate-800 flex flex-col transition-all duration-300",u?"hidden sm:flex":"flex"),children:[e.jsx("div",{className:"p-5 border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50",children:e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary-100 flex items-center justify-center text-primary-600",children:e.jsx(o,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-slate-800 dark:text-slate-100 truncate max-w-[150px]",children:a}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:l})]})]})}),e.jsx("div",{className:"p-4 space-y-3",children:e.jsxs("button",{onClick:()=>{m(null),h(!0)},className:"w-full py-3 px-4 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold shadow-lg shadow-primary-500/20 transition-all flex items-center justify-center gap-2",children:[e.jsx(c,{className:"h-5 w-5"}),e.jsx("span",{children:"New Note"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 custom-scrollbar bg-slate-50/30",children:f?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(t=>e.jsx("div",{className:"h-20 bg-slate-100 rounded-xl animate-pulse"},t))}):0===r.length?e.jsxs("div",{className:"text-center py-10 text-slate-400",children:[e.jsx(d,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No notes yet."}),e.jsx("p",{className:"text-xs",children:"Create one to get started!"})]}):r.map(t=>e.jsxs("div",{onClick:()=>{m(t),h(!0)},className:v("p-4 rounded-xl border transition-all cursor-pointer hover:shadow-md text-left group",(null==x?void 0:x.id)===t.id?"bg-white border-primary-500 shadow-md ring-1 ring-primary-500":"bg-white border-slate-200 hover:border-primary-300"),children:[e.jsx("h3",{className:"font-bold text-slate-800 mb-1 truncate group-hover:text-primary-600 transition-colors",children:t.title}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:t.content||"Empty note..."}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-2 text-right",children:new Date(t.updatedAt).toLocaleDateString()})]},t.id))})]}),e.jsx("div",{className:v("flex-1 flex flex-col bg-slate-50 dark:bg-slate-950",u?"flex":"hidden sm:flex"),children:u?e.jsx(D,{noteId:null==x?void 0:x.id,subjectId:N,initialTitle:null==x?void 0:x.title,initialContent:null==x?void 0:x.content,onClose:()=>{h(!1),m(null)},onSave:w}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300 p-8 text-center bg-slate-50/50",children:[e.jsx("div",{className:"w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(o,{className:"h-10 w-10 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-400 mb-2",children:"Select a note to view"}),e.jsxs("p",{className:"max-w-xs mx-auto text-sm",children:["Or create a new one to start building your knowledge base for ",a,"."]})]})}),e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 bg-white/50 hover:bg-white rounded-full text-slate-500 hover:text-red-500 transition-all z-10",children:e.jsx(i,{className:"h-5 w-5"})})]})]}),document.body)}const A=[{text:"The capacity to learn is a gift; the ability to learn is a skill; the willingness to learn is a choice.",author:"Brian Herbert"},{text:"Education is the most powerful weapon which you can use to change the world.",author:"Nelson Mandela"},{text:"Live as if you were to die tomorrow. Learn as if you were to live forever.",author:"Mahatma Gandhi"},{text:"The beautiful thing about learning is that no one can take it away from you.",author:"B.B. King"},{text:"Education is not the filling of a pail, but the lighting of a fire.",author:"W.B. Yeats"},{text:"Develop a passion for learning. If you do, you will never cease to grow.",author:"Anthony J. D'Angelo"},{text:"The roots of education are bitter, but the fruit is sweet.",author:"Aristotle"}];function I(){const{user:t}=w(),[a,l]=j.useState(null),[r,n]=j.useState(null),[i,c]=j.useState("Student"),[d,p]=j.useState(0),[g,b]=j.useState(new Date),[N,D]=j.useState(A[0]),[I,E]=j.useState(75),[L,q]=j.useState(0),[M,z]=j.useState(0),[B,U]=j.useState(null),[O,Q]=j.useState(!1),[F,H]=j.useState(null);return j.useEffect(()=>{const e=setInterval(()=>{b(new Date)},1e3),t=(new Date).getDate();return D(A[t%A.length]),()=>clearInterval(e)},[]),j.useEffect(()=>{if(!t)return;const e=async()=>{const{data:e}=await y.from("profiles").select("full_name, attendance_goal, cgpa, credits, avatar_url").eq("id",t.id).single();e&&(e.full_name&&c(e.full_name.split(" ")[0]),e.attendance_goal&&E(e.attendance_goal),e.cgpa&&q(e.cgpa),e.credits&&z(e.credits),e.avatar_url&&U(e.avatar_url));const s=(new Date).toLocaleDateString("en-US",{weekday:"long"}),a=["Saturday","Sunday"].includes(s)?"Monday":s,{data:r}=await y.from("timetable_entries").select("*").eq("user_id",t.id).eq("day",a),{data:i}=await y.from("smart_timetable_entries").select("*").eq("user_id",t.id).eq("day",a),o=[...r||[],...i||[]];o.sort((e,t)=>e.start_time.localeCompare(t.start_time));const d=new Date,x=d.getHours().toString().padStart(2,"0")+":"+d.getMinutes().toString().padStart(2,"0"),m=o.find(e=>e.start_time<=x&&e.end_time>x),u=o.find(e=>e.start_time>x);n(m||null),l(u||o[0]);const{data:h}=await y.from("attendance_logs").select("status").eq("user_id",t.id);if(h&&h.length>0){const e=h.filter(e=>"present"===e.status).length,t=h.length;p(Math.round(e/t*100))}};e();const s=setInterval(e,6e4);return()=>clearInterval(s)},[t]),e.jsxs("div",{className:"p-6 space-y-8 pb-24 staggered-fade-in",children:[e.jsx(k,{title:"Dashboard",description:"View your daily schedule, attendance stats, and upcoming classes."}),e.jsxs("div",{className:"mt-4 flex justify-between items-end",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[B&&e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border-2 border-white shadow-md",children:e.jsx("img",{src:B,alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-800",children:["Hello, ",e.jsx("span",{className:"text-primary-600",children:i})]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Ready to learn?"})]})]}),e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-700 font-mono",children:g.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),e.jsx("div",{className:"text-xs text-slate-400 font-medium",children:g.toLocaleDateString([],{weekday:"long",month:"short",day:"numeric"})})]})]}),e.jsxs("div",{className:"sm:hidden flex justify-between items-center bg-white/50 p-3 rounded-xl border border-white/50 shadow-sm",children:[e.jsx("div",{className:"text-xs text-slate-500 font-medium",children:g.toLocaleDateString([],{weekday:"long",month:"short",day:"numeric"})}),e.jsx("div",{className:"text-xl font-bold text-slate-700 font-mono",children:g.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})})]}),e.jsxs("div",{className:v("glass-card rounded-3xl p-6 relative overflow-hidden group transition-all duration-500",r?"border-primary-500/30 shadow-primary-200":""),children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary-500/10 rounded-full -mr-10 -mt-10 transition-transform group-hover:scale-150 duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r?e.jsxs("span",{className:"bg-red-100 text-red-600 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider flex items-center gap-1.5 animate-pulse",children:[e.jsx(x,{className:"h-3 w-3"}),"Live Now"]}):e.jsx("span",{className:"bg-primary-100 text-primary-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider",children:"Up Next"}),e.jsxs("div",{className:"flex gap-2",children:[(r||a)&&e.jsx("button",{onClick:()=>{return e=(r||a).subject_name,t=(r||a).subject_code,H({name:e,code:t}),void Q(!0);var e,t},className:"bg-white/50 hover:bg-white text-primary-600 p-2 rounded-full transition-colors",title:"Open Notes",children:e.jsx(o,{className:"h-4 w-4"})}),e.jsx(s,{className:v("h-5 w-5",r?"text-red-400":"text-primary-400")})]})]}),r?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-1",children:r.subject_name}),e.jsx("p",{className:"text-slate-500 font-medium mb-6",children:r.subject_code}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(s,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-semibold",children:["Ends at ",r.end_time.slice(0,5)]})]}),r.room_number&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:r.room_number})]})]})]}):a?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-1",children:a.subject_name}),e.jsx("p",{className:"text-slate-500 font-medium mb-6",children:a.subject_code}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(s,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-semibold",children:[a.start_time.slice(0,5)," - ",a.end_time.slice(0,5)]})]}),a.room_number&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-semibold",children:a.room_number})]})]})]}):e.jsx("div",{className:"py-8 text-center text-slate-400",children:e.jsx("p",{children:"No classes scheduled for today!"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"glass-card rounded-2xl p-4 flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:v("w-12 h-12 rounded-2xl flex items-center justify-center mb-3 group-hover:scale-110 transition-transform",d<I?"bg-red-100 text-red-600":"bg-primary-100 text-primary-600"),children:e.jsx(s,{className:"h-6 w-6"})}),e.jsxs("div",{className:v("text-2xl font-bold mb-1",d<I?"text-red-600":"text-slate-800"),children:[d,"%"]}),e.jsx("div",{className:"text-xs text-slate-500 font-medium",children:"Attendance"})]}),e.jsxs("div",{className:"glass-card p-5 rounded-3xl flex flex-col items-center justify-center text-center hover:bg-white/60 transition-colors cursor-pointer group shadow-sm hover:shadow-md",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-pink-100 flex items-center justify-center text-pink-600 mb-3 group-hover:scale-110 transition-transform",children:e.jsx(u,{className:"h-6 w-6"})}),e.jsx("div",{className:"text-2xl font-bold text-slate-800 mb-1",children:L>0?L:"-"}),e.jsx("div",{className:"text-xs text-slate-500 font-medium",children:"CGPA"})]}),e.jsxs("div",{className:"glass-card p-5 rounded-3xl flex flex-col items-center justify-center text-center hover:bg-white/60 transition-colors cursor-pointer group shadow-sm hover:shadow-md",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-blue-100 flex items-center justify-center text-blue-600 mb-3 group-hover:scale-110 transition-transform",children:e.jsx(h,{className:"h-6 w-6"})}),e.jsx("div",{className:"text-2xl font-bold text-slate-800 mb-1",children:M>0?M:"-"}),e.jsx("div",{className:"text-xs text-slate-500 font-medium",children:"Credits"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(S,{}),e.jsx(_,{}),e.jsx(C,{})]}),e.jsxs("div",{className:"glass-card p-6 rounded-3xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary-100 rounded-full blur-3xl -mr-16 -mt-16 opacity-50"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(f,{className:"h-5 w-5 text-primary-500"}),e.jsx("h3",{className:"font-bold text-slate-700",children:"Quote of the Day"})]}),e.jsxs("p",{className:"text-slate-600 italic mb-2",children:['"',N.text,'"']}),e.jsxs("p",{className:"text-sm text-primary-600 font-medium",children:["- ",N.author]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:()=>window.location.href="/developer",className:"glass-card px-6 py-2 rounded-full flex items-center gap-2 text-slate-500 font-medium text-sm hover:bg-white/60 transition-all group hover:scale-105",children:[e.jsx("span",{children:"Made by Developer"}),e.jsx("div",{className:"w-5 h-5 rounded-full bg-slate-200 flex items-center justify-center group-hover:bg-primary-100 group-hover:text-primary-600 transition-colors",children:e.jsx("span",{className:"text-[10px]",children:"Dev"})})]})}),T&&F&&e.jsx(T,{isOpen:O,onClose:()=>Q(!1),subjectName:F.name,subjectCode:F.code})]})}export{I as Dashboard};
