import{j as e,P as t,z as s,d as a,C as r,J as o,T as n}from"./ui-vendor-BLIzfsG8.js";import{r as i}from"./react-vendor-DR97ylRc.js";import{d}from"./db-CqolmD4V.js";import{b as l,a as c,c as m}from"./index-DrLrQOgi.js";import{S as u}from"./SEO-CdnxbQFe.js";import{a as x,b as p,D as g,e as h,f as b,T as f,P as j,u as v,S as w,v as y,C as N}from"./dnd-vendor-CnZsZbFp.js";import"./pdf-vendor-D0-bFhii.js";import"./supabase-vendor-C9Ts7tiD.js";const k=[{id:"todo",title:"To Do",color:"bg-slate-100 border-slate-200",icon:s},{id:"in-progress",title:"In Progress",color:"bg-blue-50 border-blue-100",icon:a},{id:"done",title:"Completed",color:"bg-emerald-50 border-emerald-100",icon:r}];function D(){const{addXP:s}=l(),{addToast:a}=c(),[r,o]=i.useState([]),[n,m]=i.useState(null),[v,w]=i.useState(""),y=x(p(j,{activationConstraint:{distance:5}}),p(f));i.useEffect(()=>{N()},[]);const N=async()=>{try{const e=(await d.getAllTasks()).map(e=>({...e,status:e.status?e.status:e.completed?"done":"todo"}));o(e.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime()))}catch(e){}},D=async e=>{confirm("Delete this task?")&&(await d.deleteTask(e),o(r.filter(t=>t.id!==e)))},S=async(e,t)=>{const n=r.find(t=>t.id===e);if(!n||n.status===t)return;const i={...n,status:t};o(r.map(t=>t.id===e?i:t)),await d.saveTask(i),"done"===t&&(s(50,"Task Completed"),a("Task completed! +50 XP","success"))};return e.jsxs("div",{className:"min-h-screen p-2 md:p-6 pb-24 space-y-6",children:[e.jsx(u,{title:"Kanban Board",description:"Manage your tasks efficiently."}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-extrabold text-slate-800 tracking-tight",children:"Assignments"}),e.jsx("p",{className:"text-slate-400 font-medium md:-mt-1 text-sm",children:"Drag and drop to manage your workload."})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!v.trim())return;const t={id:crypto.randomUUID(),text:v.trim(),status:"todo",createdAt:new Date};await d.saveTask(t),o([t,...r]),w(""),s(10,"Task Created")},className:"flex gap-2 w-full md:w-auto mt-4 md:mt-0",children:[e.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),placeholder:"Add new assignment...",className:"glass-input px-5 py-3 rounded-2xl focus:ring-2 focus:ring-primary-500 w-full md:w-80 shadow-sm border-white/60 bg-white/70 backdrop-blur-md"}),e.jsx("button",{type:"submit",disabled:!v.trim(),className:"bg-slate-800 text-white p-3 rounded-2xl hover:bg-slate-900 transition-all disabled:opacity-50 hover:scale-105 active:scale-95 shadow-lg shadow-slate-300",children:e.jsx(t,{className:"h-6 w-6"})})]})]}),e.jsxs(g,{sensors:y,collisionDetection:h,onDragStart:e=>{m(e.active.id)},onDragEnd:async e=>{const{active:t,over:n}=e;if(m(null),!n)return;const i=r.find(e=>e.id===t.id);if(!i)return;let l=null;if(k.some(e=>e.id===n.id))l=n.id;else{const e=r.find(e=>e.id===n.id);e&&(l=e.status)}if(l&&l!==i.status){const e={...i,status:l};o(r.map(s=>s.id===t.id?e:s)),await d.saveTask(e),"done"===l&&"done"!==i.status&&(s(50,"Task Completed"),a("Task moved to Completed! +50 XP","success"))}},children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 h-full items-start mt-6",children:k.map(t=>e.jsx(T,{column:t,tasks:r.filter(e=>e.status===t.id),onDelete:D,onUpdateStatus:S},t.id))}),e.jsx(b,{children:n?e.jsx(C,{task:r.find(e=>e.id===n),onDelete:()=>{},onUpdateStatus:()=>{},isOverlay:!0}):null})]})]})}function T({column:t,tasks:s,onDelete:a,onUpdateStatus:r}){const{setNodeRef:o}=v({id:t.id,data:{type:"Column",column:t}});return e.jsxs("div",{ref:o,className:m("rounded-[1.5rem] p-3 min-h-[500px] border border-white/40 transition-all duration-300",t.color),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 text-slate-600 font-bold uppercase text-xs tracking-widest pl-2",children:[e.jsx(t.icon,{className:"h-4 w-4"}),t.title,e.jsx("span",{className:"bg-white/60 px-2.5 py-0.5 rounded-full text-[10px] ml-auto font-extrabold shadow-sm text-slate-500",children:s.length})]}),e.jsx(w,{items:s.map(e=>e.id),strategy:y,children:e.jsxs("div",{className:"space-y-3",children:[s.map(t=>e.jsx(S,{task:t,onDelete:a,onUpdateStatus:r},t.id)),0===s.length&&e.jsx("div",{className:"h-32 flex flex-col items-center justify-center text-slate-400/50 text-xs font-bold uppercase tracking-wider border-2 border-dashed border-slate-200/50 rounded-2xl",children:e.jsx("span",{children:"Drop Here"})})]})})]})}function S({task:t,onDelete:s,onUpdateStatus:a}){const{attributes:r,listeners:o,setNodeRef:n,transform:i,transition:d,isDragging:l}=v({id:t.id,data:{type:"Task",task:t}}),c={transform:N.Transform.toString(i),transition:d};return e.jsx("div",{ref:n,style:c,...r,...o,className:"touch-none sensitive-touch",children:e.jsx(C,{task:t,onDelete:s,onUpdateStatus:a,isDragging:l})})}function C({task:t,onDelete:s,isDragging:r,isOverlay:i}){return e.jsxs("div",{className:m("glass-card p-4 rounded-xl flex items-start gap-3 group bg-white/80 hover:bg-white shadow-sm hover:shadow-md border border-white/60 transition-all duration-300 relative overflow-hidden",r&&"opacity-40 scale-95",i&&"rotate-2 scale-105 shadow-2xl cursor-grabbing ring-4 ring-white/50 ring-offset-0 z-50 bg-white"),children:[e.jsx("div",{className:m("absolute left-0 top-0 bottom-0 w-1.5 transition-colors duration-300","done"===t.status?"bg-emerald-400":"in-progress"===t.status?"bg-blue-400":"bg-slate-200")}),e.jsx("button",{className:"mt-1 text-slate-300 cursor-grab active:cursor-grabbing hover:text-slate-500 transition-colors hidden md:block",children:e.jsx(o,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0 pl-2",children:[e.jsx("p",{className:m("text-sm font-bold text-slate-700 break-words leading-relaxed transition-all","done"===t.status&&"text-slate-400 line-through decoration-slate-300"),children:t.text}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 bg-slate-50 px-2 py-0.5 rounded-md border border-slate-100",children:new Date(t.createdAt).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),"in-progress"===t.status&&e.jsxs("span",{className:"text-[10px] font-bold text-blue-500 bg-blue-50 px-2 py-0.5 rounded-md border border-blue-100 flex items-center gap-1",children:[e.jsx(a,{className:"w-3 h-3"})," In Progress"]})]})]}),e.jsx("div",{className:"flex flex-col gap-1 -mr-1",children:e.jsx("button",{onClick:e=>{e.stopPropagation(),s(t.id)},className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-xl transition-all opacity-0 group-hover:opacity-100 md:translate-x-2 group-hover:translate-x-0",onPointerDown:e=>e.stopPropagation(),children:e.jsx(n,{className:"h-4 w-4"})})})]})}export{D as Tasks};
