import{j as e,v as t,c as s,a4 as a,a5 as l,X as r,g as n,p as i,h as o,a6 as d}from"./ui-vendor-yoAZ-FXJ.js";import{r as c}from"./react-vendor-DR97ylRc.js";import{c as u,u as x,a as m,s as b,d as p}from"./index-CNb4MtWx.js";import{S as h}from"./SEO-DgSy9wkE.js";import"./pdf-vendor-CnZj0n1s.js";import"./supabase-vendor-C9Ts7tiD.js";const f=[{label:"S",value:10,color:"text-purple-500 bg-purple-100 border-purple-200"},{label:"A",value:9,color:"text-blue-500 bg-blue-100 border-blue-200"},{label:"B",value:8,color:"text-green-500 bg-green-100 border-green-200"},{label:"C",value:7,color:"text-yellow-500 bg-yellow-100 border-yellow-200"},{label:"D",value:6,color:"text-orange-500 bg-orange-100 border-orange-200"},{label:"E",value:5,color:"text-red-500 bg-red-100 border-red-200"},{label:"F",value:0,color:"text-slate-500 bg-slate-100 border-slate-200"},{label:"N",value:0,color:"text-slate-400 bg-slate-50 border-slate-200"}];function g({subjectName:s,credits:a,currentGrade:l,onChange:r,onDelete:n,onEdit:i}){const o=f.findIndex(e=>e.label===l),d=7-o,c=f[o];return e.jsxs("div",{className:"glass-card p-4 rounded-2xl relative group transition-all duration-300 hover:shadow-lg border border-white/40",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:i,className:"text-slate-300 hover:text-primary-400 p-1 transition-colors",children:e.jsx(t,{className:"h-4 w-4"})}),e.jsx("button",{onClick:n,className:"text-slate-300 hover:text-red-400 p-1 transition-colors",children:"Ã—"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-800",children:s}),e.jsxs("p",{className:"text-xs text-slate-500 font-medium",children:[a," Credits"]})]}),e.jsx("div",{className:u("w-10 h-10 rounded-xl flex items-center justify-center font-bold text-xl transition-all duration-300 shadow-sm border",c.color),children:l})]}),e.jsx("div",{className:"relative h-6 flex items-center",children:e.jsx("input",{type:"range",min:"0",max:"7",step:"1",value:d,onChange:e=>{const t=parseInt(e.target.value);r(f[7-t].label)},className:"w-full h-2 bg-slate-200 rounded-full appearance-none cursor-pointer accent-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500/50"})}),e.jsxs("div",{className:"flex justify-between mt-2 text-[10px] font-bold text-slate-400 px-1",children:[e.jsx("span",{children:"N"}),e.jsx("span",{children:"E"}),e.jsx("span",{children:"C"}),e.jsx("span",{children:"A"}),e.jsx("span",{children:"S"})]})]})}function j({gpa:t,totalCredits:r,initialGpa:n}){const[i,o]=c.useState(0),[d,x]=c.useState(!1);c.useEffect(()=>{const e=(t-i)/60;let s=i;const a=setInterval(()=>{s+=e,e>0&&s>=t||e<0&&s<=t?(o(t),clearInterval(a),t>=9&&x(!0)):o(s)},1e3/60);return()=>clearInterval(a)},[t]);const m=e=>e>=9?"text-purple-600":e>=8?"text-blue-600":e>=7?"text-green-600":e>=5?"text-orange-600":"text-red-600",b=n?t-n:0;return e.jsxs("div",{className:"glass-card p-6 rounded-3xl text-center relative overflow-hidden transition-all duration-500 hover:shadow-2xl hover:shadow-primary-500/10",children:[d&&e.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-2 h-2 bg-red-400 rounded-full animate-bounce delay-75"}),e.jsx("div",{className:"absolute top-10 right-1/4 w-2 h-2 bg-blue-400 rounded-full animate-bounce delay-150"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-500 uppercase tracking-widest mb-2",children:"Projected CGPA"}),e.jsxs("div",{className:u("text-6xl font-black mb-2 transition-colors duration-500 flex items-center justify-center gap-2",m(i)),children:[i.toFixed(2),t>=9&&e.jsx(s,{className:"h-8 w-8 text-yellow-400 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[n&&Math.abs(b)>.01&&e.jsxs("div",{className:u("flex items-center gap-1 text-xs font-bold px-2 py-1 rounded-full",b>0?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[b>0?e.jsx(a,{className:"h-3 w-3"}):e.jsx(l,{className:"h-3 w-3"}),Math.abs(b).toFixed(2)]}),e.jsxs("div",{className:"bg-slate-100 text-slate-600 px-3 py-1 rounded-full text-xs font-bold",children:[r," Credits"]})]}),e.jsx("p",{className:u("font-medium text-lg animate-fade-in",m(t)),children:(p=t,p>=9.5?"Absolute Legend! ðŸ†":p>=9?"Outstanding! â­":p>=8.5?"Excellent Work! ðŸš€":p>=8?"Great Job! ðŸ‘":p>=7?"Good, keep pushing! ðŸ’ª":p>=5?"You can do better! ðŸ“š":"Warning Zone! âš ï¸")})]}),e.jsx("div",{className:u("absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-32 h-32 rounded-full blur-[60px] -z-10 opacity-20 transition-colors duration-700",t>=9?"bg-purple-500":t>=8?"bg-blue-500":t>=5?"bg-orange-500":"bg-red-500")})]});var p}function v({isOpen:t,onClose:s,onSuccess:a,initialData:l}){return t?e.jsx(y,{isOpen:t,onClose:s,onSuccess:a,initialData:l},l?`edit-${l.name}`:"add-new"):null}function y({onClose:t,onSuccess:s,initialData:a}){const[l,o]=c.useState((null==a?void 0:a.name)||""),[d,u]=c.useState((null==a?void 0:a.credits)||3),[x,m]=c.useState(!1);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-xl rounded-3xl shadow-2xl w-full max-w-md overflow-hidden border border-white/50 animate-in fade-in zoom-in duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:a?"Edit Subject":"Add New Subject"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:e.jsx(r,{className:"h-5 w-5 text-slate-500"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m(!0);try{if(!l.trim())return;if(d<0)return;s({name:l,credits:d}),t()}catch(a){}finally{m(!1)}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Subject Name"}),e.jsx("input",{type:"text",value:l,onChange:e=>o(e.target.value),placeholder:"e.g. Operating Systems",className:"w-full p-3 rounded-xl bg-slate-50 border-none focus:ring-2 focus:ring-primary-500 transition-all font-medium",autoFocus:!0,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Credits"}),e.jsx("input",{type:"number",value:d,onChange:e=>u(parseInt(e.target.value)||0),min:"1",max:"10",className:"w-full p-3 rounded-xl bg-slate-50 border-none focus:ring-2 focus:ring-primary-500 transition-all font-medium",required:!0})]}),e.jsxs("button",{type:"submit",disabled:x,className:"w-full py-3 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-bold shadow-lg shadow-primary-200 transition-all flex items-center justify-center gap-2 mt-4 active:scale-95",children:[x?e.jsx(n,{className:"h-5 w-5 animate-spin"}):e.jsx(i,{className:"h-5 w-5"}),a?"Update Subject":"Add Subject"]})]})]})})})}const w={S:10,A:9,B:8,C:7,D:6,E:5,F:0,N:0};function N(){const{user:t}=x(),{addToast:s}=m(),[a,l]=c.useState([]),[r,n]=c.useState(0),[i,u]=c.useState(0),[f,y]=c.useState(null),[N,S]=c.useState(null),[C,k]=c.useState(!1),[E,A]=c.useState(!1),[D,G]=c.useState(null);c.useEffect(()=>{if(t){(async()=>{const{data:e}=await b.from("profiles").select("cgpa, credits").eq("id",t.id).single();e&&(e.cgpa&&y(e.cgpa),e.credits&&S(e.credits))})()}},[t]),c.useEffect(()=>{(async()=>{const e=await p.getAllSimulatorSubjects();if(e&&e.length>0){const t=e.map(e=>({...e,grade:e.grade}));l(t)}})()},[]),c.useEffect(()=>{I()},[a,C,f,N]);const I=()=>{let e=0,t=0;if(a.forEach(s=>{const a=w[s.grade];e+=a*s.credits,t+=s.credits}),C&&null!=f&&null!=N){const s=N+t;n(s>0?(f*N+e)/s:0),u(s)}else n(t>0?e/t:0),u(t)};return e.jsxs("div",{className:"pb-24 space-y-4 md:space-y-8",children:[e.jsx(h,{title:"CGPA Simulator",description:"Predict your future grades with our interactive GPA calculator."}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-800",children:"Simulator"}),e.jsx("p",{className:"text-slate-500 text-sm md:text-base",children:"Play with grades to see your future."})]}),e.jsx(j,{gpa:r,totalCredits:i,initialGpa:C?f||0:void 0}),null!==f&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"bg-white/50 backdrop-blur-sm p-1 rounded-xl flex gap-1 border border-white/40 shadow-sm",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-xs md:text-sm font-bold transition-all "+(C?"text-slate-500 hover:text-slate-700":"bg-white shadow-sm text-primary-600"),children:"Semester Only"}),e.jsx("button",{onClick:()=>k(!0),className:"px-3 py-1.5 md:px-4 md:py-2 rounded-lg text-xs md:text-sm font-bold transition-all "+(C?"bg-white shadow-sm text-primary-600":"text-slate-500 hover:text-slate-700"),children:"Cumulative Effect"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:a.map(t=>e.jsx(g,{subjectName:t.name,credits:t.credits,currentGrade:t.grade,onChange:e=>(async(e,t)=>{const s=a.map(s=>s.id===e?{...s,grade:t}:s);l(s);const r=s.find(t=>t.id===e);r&&await p.saveSimulatorSubject(r)})(t.id,e),onDelete:()=>(async e=>{l(t=>t.filter(t=>t.id!==e)),await p.deleteSimulatorSubject(e),s("Subject deleted","info")})(t.id),onEdit:()=>(e=>{G(e),A(!0)})(t)},t.id))}),e.jsxs("div",{className:"flex justify-center gap-4 pt-4",children:[e.jsxs("button",{onClick:()=>{G(null),A(!0)},className:"flex items-center gap-2 bg-primary-600 text-white px-6 py-3 rounded-full font-bold shadow-lg shadow-primary-500/30 hover:bg-primary-700 transition-all active:scale-95 text-sm md:text-base",children:[e.jsx(o,{className:"h-5 w-5"}),"Add Subject"]}),e.jsxs("button",{onClick:async()=>{await Promise.all(a.map(e=>p.deleteSimulatorSubject(e.id))),l([]),s("Simulator reset","info")},className:"flex items-center gap-2 bg-white text-slate-600 px-6 py-3 rounded-full font-bold shadow-sm hover:bg-slate-50 transition-all text-sm md:text-base",children:[e.jsx(d,{className:"h-5 w-5"}),"Reset"]})]}),e.jsx(v,{isOpen:E,onClose:()=>{A(!1),G(null)},onSuccess:async e=>{if(D){const t={...D,name:e.name,credits:e.credits},r=a.map(e=>e.id===D.id?t:e);l(r),await p.saveSimulatorSubject(t),G(null),s("Subject updated successfully","success")}else{const t={id:crypto.randomUUID(),name:e.name,credits:e.credits,grade:"A"};l([...a,t]),await p.saveSimulatorSubject(t),s("Subject added successfully","success")}},initialData:D?{name:D.name,credits:D.credits}:void 0})]})}export{N as Simulator};
